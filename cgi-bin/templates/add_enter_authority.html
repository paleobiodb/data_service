
<script language="JavaScript" type="text/javascript">
<!-- Begin


function checkForm()	{

        var frm = document.forms[1];
        var error = "";

	var hasLength = frm.ref_is_authority.length - 1;

	if ( / (sp|spp|indet)$/.test(frm.taxon_name.value) )	{
		error += "* Taxon names can't end with sp, spp, or indet.\nAre you actually trying to enter an occurrence belonging to a collection?\n";
	}

	if ( / .* /.test(frm.taxon_name.value) && ! / \([A-Z][a-z]+\) /.test(frm.taxon_name.value) && frm.taxon_rank.value != "subspecies" )	{
		error += "* Only subspecies names include two spaces\n";
	} else if ( ! / .* /.test(frm.taxon_name.value) && frm.taxon_rank.value == "subspecies" )	{
		error += "* A subspecies name must include two spaces\n";
	} else if ( / /.test(frm.taxon_name.value) && ! /species|subgenus/.test(frm.taxon_rank.value) )	{
		error += "* Only species and subgenus names include spaces\n";
	} else if ( ! / /.test(frm.taxon_name.value) && frm.taxon_rank.value == "species" )	{
		error += "* A species name must include a space\n";
	} else if ( ! / /.test(frm.taxon_name.value) && frm.taxon_rank.value == "subgenus" )	{
		error += "* A subgenus name must include a space\n";
	} else if ( ! / \(.*\)/.test(frm.taxon_name.value) && frm.taxon_rank.value == "subgenus" )	{
		error += "* A subgenus name must be within parentheses\n";
	} else if ( ! /^[A-Z][a-z]+ [a-z]+ [a-z]+$/.test(frm.taxon_name.value) && frm.taxon_rank.value == "subspecies" )	{
		error += "* The name '" + frm.taxon_name.value + "' doesn't look like a subspecies\n";
	} else if ( ! /^[A-Z][a-z]+ (|\([A-Z][a-z]+\) )[a-z]+$/.test(frm.taxon_name.value) && frm.taxon_rank.value == "species" )	{
		error += "* The name '" + frm.taxon_name.value + "' doesn't look like a species\n";
	} else if ( ! /^[A-Z][a-z]+ \([A-Z][a-z]+\)$/.test(frm.taxon_name.value) && frm.taxon_rank.value == "subgenus" )	{
	error += "* The name '" + frm.taxon_name.value + "' doesn't look like a subgenus\n";
	} else if ( ! /^[A-Z][a-z]+$/.test(frm.taxon_name.value) && ! /(species|subgenus)/.test(frm.taxon_rank.value) )	{
		error += "* The name '" + frm.taxon_name.value + "' is misformatted\n";
	}

	if ( ( frm.author1init.value != "" || frm.author1last.value != "" || frm.author2init.value != "" || frm.author2last.value != "" || frm.pubyr.value != "" ) && ! frm.ref_is_authority[hasLength].checked )	{
		error += "* You forgot to check 'it was named in an earlier publication'\n";
	}
	if ( ( frm.author1init.value != "" || frm.pubyr.value != "" ) && frm.author1last.value == "" )	{
		error += "* You forgot to enter the author name\n";
	} else if ( frm.ref_is_authority[hasLength].checked && frm.author1last.value == "" && /species|genus/.test(frm.taxon_rank.value) )	{
		error += "* You forgot to enter the author name\n";
	}
	// unicode values are for a-grave, a-acute, e-grave, e-acute, n-tilde, u-umlaut
	if ( frm.author1last.value != "" && /[^A-Za-z\u00E0\u00E1\u00E8\u00E9\u00F1\u00FC'\- ]/.test(frm.author1last.value) && ! /, Jr\./.test(frm.author1last.value) )	{
		error += "* There seems to be a typo in the first author's last name\n";
	} else if ( frm.author1last.value != "" && ! /^(|d'|d[aeo](|[nrs]) |Di|O'|M(c|ac|')|v[ao]n )[A-Z](|[a-z]+-[A-Z])[a-z\u00E0\u00E1\u00E8\u00E9\u00F1\u00FC]+(|, Jr\.)$/.test(frm.author1last.value) && ! /^[A-Z][a-z]+ (|[dv][a-z]+ )[A-Z][a-z]+(|, Jr\.)$/.test(frm.author1last.value) )	{
                error += "* The first author's last name is misformatted\n";
	}
	if ( frm.author2init.value != "" && ! /^[A-Z]\.$/.test(frm.author2init.value) && ! /^[A-Z]\.( |\-)[A-Z]\.$/.test(frm.author2init.value) && ! /^[A-Z]\. [A-Z]\. [A-Z]\.$/.test(frm.author2init.value)  )	{
		error += "* The second author's initials are misformatted\n";
	}
	if ( frm.author2last.value != "" && /[^A-Za-z\u00E0\u00E1\u00E8\u00E9\u00F1\u00FC'\- ]/.test(frm.author2last.value) && ! /, Jr\./.test(frm.author2last.value) )	{
		error += "* There seems to be a typo in the second author's last name\n";
	} else if ( frm.author2last.value != "" && ! /^(|d'|d[aeo](|[nrs]) |Di|O'|M(c|ac|')|v[ao]n )[A-Z](|[a-z]+-[A-Z])[a-z\u00E0\u00E1\u00E8\u00E9\u00F1\u00FC]+(|, Jr\.)$/.test(frm.author2last.value) && ! /^[A-Z][a-z]+ (|[dv][a-z]+ )[A-Z][a-z]+(|, Jr\.)$/.test(frm.author2last.value) )	{
		error += "* The second author's last name is misformatted\n";
	}
	if ( /[^0-9]/.test(frm.pubyr.value) )	{
		error += "* The publication year is misformatted\n";
	} else if ( frm.pubyr.value != "" && ( frm.pubyr.value < 1758 || frm.pubyr.value > 2020 ) )	{
		error += "* The publication year is wrong\n";
	}
	if ( typeof(frm.type_specimen) != "undefined" && frm.type_specimen.value != "" && frm.extant.selectedIndex == 0 )	{
		error += "* If you know the type's number you must know whether the taxon is extant\n";
	} else if ( typeof(frm.type_body_part) != "undefined" && frm.type_body_part.value != "" && frm.extant.selectedIndex == 0 )	{
		error += "* If you know the type's body part you must know whether the taxon is extant\n";
	}
	if ( typeof(frm.preservation) != "undefined" )	{
		var pres = frm.preservation.options[frm.preservation.selectedIndex].text;
		if ( pres == 'not a trace' )	{
			error += "* We are no longer using the 'not a trace' category; please select another value\n";
		}
		if ( pres != 'body (3D)' && pres != 'amber' && frm.extant.selectedIndex == 2 && ( /species/.test(frm.taxon_rank.value) || pres != "" ) )	{
			error += "* If the type isn't a body or in amber the taxon can't be extant\n";
		}
	} else if ( typeof(frm.preservation2) != "undefined" )	{
		var pres = frm.preservation2.options[frm.preservation2.selectedIndex].text;
		if ( pres == 'not a trace' )	{
			error += "* We are no longer using the 'not a trace' category; please select another value\n";
		}
		if ( pres != 'body (3D)' && pres != 'amber' && frm.extant.selectedIndex == 2 && ( /species/.test(frm.taxon_rank.value) || pres != "" ) )	{
			error += "* If the type isn't a body or in amber the taxon can't be extant\n";
		}
	}
	if ( /^([^a-z][A-Za-z]*)(| [^a-z][A-Za-z]*)(| [^a-z][A-Za-z]*)$/.test(frm.common_name.value) )	{
		error += "* Don't capitalize the common name\n";
	} else if ( /[^A-Za-z ']/.test(frm.common_name.value) || /[^a-z]$/.test(frm.common_name.value) )	{
		error += "* The common name is misformatted\n";
	}

	if ( error != "" )	{
		alert(error);
		return false;
	}
	return true;

}

// End -->
</script>


<span id="message"></span>

<div align="center" style="width: 50em;"><p class="pageTitle">Authority data for <span id="taxon_name"></span></p></div>

<div show="error_message">
<span id="error_message"></span>
</div>

<form method="POST" action="%%write_url%%" onSubmit="return checkForm();">

<div class="displayPanel small" style="padding-top: 1em; width: 56em;">

<div show="not_this_one">
<span id="not_this_one"></span>
</div>

<input type="hidden" id="action" name="action" value="submitAuthorityForm">
<input type="hidden" id="reference_no" name="reference_no">
<input type="hidden" id="taxon_no" name="taxon_no">
<input type="hidden" id="confirmed_taxon_name" name="confirmed_taxon_name">

<div align="left">
  <input id="ref_is_authority" name="ref_is_authority" type="radio" value="PRIMARY">
  <input type="text" id="taxon_name" name="taxon_name" size="20"> was first named in the data record's primary reference:
  <div align="left" class="small" style="width: 54em; margin-bottom: 0.5em; margin-left: 3em; text-indent: -1em;"><span id="formatted_primary_reference"></span></div>
</div>

<div show="current_reference">
  <input id="ref_is_authority" name="ref_is_authority" type="radio" value="CURRENT">
   ... <i>or</i> it was first named in the current reference:
<div align="left" class="small" style="width: 54em; margin-bottom: 0.5em; margin-left: 3em; text-indent: -1em;"><span id="formatted_current_reference"></span></div>
</div>  

  <input id="ref_is_authority" name="ref_is_authority" type="radio" value="NO">
  ... <i>or</i> it was named in an earlier publication:

<table><tr><td align="right" class="verysmall"><span class="prompt">First author:</span></td>
<td><input id="author1init" name="author1init" class="verysmall" size=4></td>
<td><input id="author1last" name="author1last" class="verysmall" size=10></td>
<td align="left" class="verysmall" style="padding-left: 0.5em";><span class="prompt">Second author:</span></td>
<td align="left"><input id="author2init" name="author2init" class="verysmall" size=4></td>
<td align="left"><input id="author2last" name="author2last" class="verysmall" size=10></td>
</tr>
<tr><td valign="top" align="right" class="verysmall" style="padding-left: 2em;"><span class="prompt">Other authors:</span></td>
<td colspan="3"><textarea id="otherauthors" name="otherauthors" class="verysmall" rows=1 cols="30"></textarea></td>
<td align="right" class="verysmall"><span class="prompt">Year:</span></td>
<td colspan="1" class="verysmall"><input id="pubyr" name="pubyr" class="verysmall" size=5></td>
</tr>

<tr>
<td colspan="4" class="verysmall" align="left" style="padding-top: 0.5em;"><span class="prompt">Pages:</span> <input id="pages" name="pages" class="verysmall" size=12>
<span class="prompt">Figures:</span> <input id="figures" name="figures" class="verysmall" size=12></td></tr>
</table>


<div style="float: left; padding-left: 1em;">

<div style="clear: right; padding-top: 1em; white-space: nowrap;">
<span class="prompt">Original rank:</span>
<span id="taxon_rank_select"></span>
</div>

<div show="original_no_select">
<div style="clear: right; padding-top: 1em; white-space: nowrap;">
<span class="prompt">Original name:</span>
<span id="original_no_select"></span>
</div>
</div>

<div hide="show_type_specimen">
<div style="clear: right; padding-top: 1em;">
<span class="prompt">Preservation category:</span>
<select id="preservation"></select>
</div>
</div>

<div show="show_type_specimen">
<div style="clear: right;">
<div style="padding-top: 1em;">
<span class="prompt">Type specimen:</span>
<input id="type_specimen" name="type_specimen" size="20">
</div>
</div>
</div>

<div show="show_type_specimen">
<div style="clear: right;">
<div style="padding-top: 1em;">
<span class="prompt">Body part of type:</span>
<select name="type_body_part"></select>
</div>
</div>
</div>

<div show="show_type_specimen">
<div style="clear: right;">
<span class="prompt">Specific body part:</span>
<input id="part_details" name="part_details" size="23">
</div>
</div>

<div show="show_type_specimen">
<div show="hide_measurements">
  <div class="small" style="width: 300px">Measurement data can not be edited here, please see the <a target="_new" href="%%write_url%%?action=displaySpecimenList&amp;types_only=1&amp;taxon_no=%%taxon_no%%">measurements form</a>.</div>
</div>
<div hide="hide_measurements">
<input type="hidden" name="specimen_no">
<div class="small" style="clear: right; white-space: nowrap;">
<span class="prompt">Length:</span>
<input class="small" name="length" size="4"> mm
&nbsp;<span class="prompt">Width:</span>
<input class="small" name="width" size="4"> mm
</div>
</div>
</div>


<div show="show_type_specimen">
<div style="padding-top: 1em;">
<span class="prompt">Type locality (PaleoDB number):</span>
<input id="type_locality" name="type_locality" size="8">
</div>
</div>

</div>

<div style="float: left; padding-top: 1em; padding-left: 2em;">

<div style="clear: right;">
<div style="white-space: nowrap;">
<span id="parent_taxon_select"></span>
</div>

<!-- Note: this should only appear if the rank is species -->
<div show="show_type_taxon">
  <div style="clear: left; padding-bottom: 1em; white-space: nowrap;">
    <span show="parent_taxon_select">&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <input type="checkbox" id="type_taxon" name="type_taxon" value="1"><span class="prompt">This is the type <span id="taxon_rank"></span></span>
  </div>
</div>

</div>

<div show="show_type_specimen">
<div style="clear: right; padding-bottom: 1em;">
<span class="prompt">Preservation category:</span>
<select id="preservation2"></select>
</div>
</div>

<div style="clear: right;">
<span class="prompt">Is this a form taxon?</span>
<select id="form_taxon"></select>
</div>

<div style="clear: right;">
<span class="prompt">Is this an extant (living) taxon?</span>
<select id="extant"></select>
</div>

<div style="clear: right; padding-top: 1em;">
<span class="prompt">Common name:
</span>
<input type="text" id="common_name" name="common_name" size="20"><br>
<span class="verysmall">Enter the most common name uncapitalized and in singular form.</span>
</div>

</div>


<div style="clear: left; padding: 1em; height: 3em;">
<div style="float: left; position: relative; left: 0em; top: 0em;">
<span class="prompt">Technical comments:</span>
</div>
<div style="float: left; position: relative; left: 0.5em; top: 0em;">
<textarea id="comments" name="comments" rows="2" cols="62">
</textarea>
</div>
</div>

<div style="clear: left; padding: 1em; height: 12em;">
<div style="float: left; position: relative; left: 0em; top: 0em;">
<span class="prompt">Discussion:</span>
</div>
<div style="float: left; position: relative; left: 0.5em; top: 0em;">
<textarea id="discussion" name="comments" rows="8" cols="70">
</textarea>
</div>
<div class="verysmall" style="float: left; width: 56em; margin-left: 2em;">
%%current_discussant%%
%%credit_me%%
Valid markup includes the HTML &lt;b&gt;, &lt;i&gt;, and &lt;u&gt; tags (but not &lt;p&gt; or &lt;br&gt;) and the wiki tags [[ ]], which autogenerate a link to a taxon, collection, or reference page.
</div>
</div>

</div>

<div style="clear: left; margin-left: 2em;">

<span show="authorizer_name">
<div align="left" class="tiny" style="margin: 1em; width: 50em;">

<div style="clear: right; padding: 0.5em; width: 56em;">
<span id="authorizer_name"></span>
<span id="enterer_name"></span>
<span id="modifier_name"></span>
</div>

<div style="padding: 0.5em;">
<span id="created"></span>
<span id="modified"></span>
</div>

</div>
</span>

<div style="clear: both; margin-left: 24em; margin-bottom: 1.5em;">
<input type="submit" value="Submit">
</div>

<div class="tiny" style="margin-left: 14em; padding-bottom: 2em;">
Please read the <a href="javascript:tipsPopup('/public/tips/taxonomy_FAQ.html#AuthorityForm')">FAQ</a>.
If the name is misspelled, <a href="%%write_url%%?action=displayAuthorityTaxonSearchForm">try another search</a>.
</div>

</div>



</form>

